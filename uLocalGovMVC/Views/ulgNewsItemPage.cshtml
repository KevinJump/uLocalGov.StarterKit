@inherits Umbraco.Web.Mvc.UmbracoTemplatePage
	@using Eksponent.CropUp
@{
    Layout = "ulgSideNavPages.cshtml";
}

		
<div class="page-header">
    <h1>@Umbraco.Field("title") <small>@Umbraco.Field("articleDate", formatAsDate: true)</small></h1>
</div>

@* we should have a partial view which encapsulates all the logic to display a cropped image *@
@{ 
    bool hasImage = false;
    string imageUrl= String.Empty;
	string imageAltText = String.Empty;
}

@if (Model.Content.HasProperty("relatedImage") && Model.Content.HasValue("relatedImage")){
		var mediaItem = Umbraco.TypedMedia(Model.Content.GetPropertyValue("relatedImage")); 
       	hasImage = true;
       	imageUrl = mediaItem.GetPropertyValue<string>("umbracoFile");
      	imageAltText = mediaItem.GetPropertyValue<string>("alternativeText");
     
if (String.IsNullOrEmpty(imageAltText)){
    imageAltText = mediaItem.Name;         
}
if (!mediaItem.GetPropertyValue<bool>("doNotCropThisImage")){
    imageUrl = CropUp.GetUrl(imageUrl,new ImageSizeArguments{ CropAlias="newsarticle", CropMode=CropUpMode.BestFit });
}
 
}   
@if (hasImage){
	<div class="pull-left"><img src="@imageUrl" alt="@imageAltText" width="300px" height="200px"/></div>
}		

@Umbraco.Field("bodyText")
@Html.Partial("ulgDisplayNewsTags",Model.Content)

@section AltSection {
    @Html.Partial("ulgNewsArchive")			
}